
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart - Dynamic Vapes</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Dynamic Vapes</h1>
        <nav>
            <a href="/index.html">Home</a>
            <a href="/cart.html">Cart <span id="cart-count">0</span></a>
        </nav>
    </header>

    <main>
        <section class="cart-items-container">
            <h2>Your Shopping Cart</h2>
            <div id="cart-items">
                <!-- Cart items will be loaded here by JavaScript -->
            </div>
            <div class="cart-total">
                Total: ₹<span id="cart-total-price">0.00</span>
            </div>
            <button id="checkout-button" class="checkout-button">Proceed to Checkout</button>
        </section>
    </main>

    <script src="cart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cartItemsContainer = document.getElementById('cart-items');
            const cartTotalPriceElement = document.getElementById('cart-total-price');
            const checkoutButton = document.getElementById('checkout-button');

            function renderCart() {
                const cart = getCart();
                cartItemsContainer.innerHTML = '';
                let totalPrice = 0;

                if (cart.length === 0) {
                    cartItemsContainer.innerHTML = '<p>Your cart is empty.</p>';
                    checkoutButton.disabled = true;
                } else {
                    checkoutButton.disabled = false;
                    cart.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'cart-item';
                        itemElement.innerHTML = `
                            <img src="./assets/images/${item.image}" alt="${item.name}">
                            <div class="cart-item-details">
                                <h3>${item.name}</h3>
                                <p>Price: ₹${item.price.toFixed(2)}</p>
                            </div>
                            <div class="cart-item-actions">
                                <input type="number" value="${item.quantity}" min="1" data-product-id="${item.id}">
                                <button data-product-id="${item.id}">Remove</button>
                            </div>
                        `;
                        cartItemsContainer.appendChild(itemElement);

                        totalPrice += item.price * item.quantity;
                    });
                }

                cartTotalPriceElement.textContent = totalPrice.toFixed(2);
                updateCartCount(); // Ensure header count is updated
            }

            // Event listener for quantity changes
            cartItemsContainer.addEventListener('change', (event) => {
                if (event.target.tagName === 'INPUT' && event.target.type === 'number') {
                    const productId = event.target.dataset.productId;
                    const newQuantity = event.target.value;
                    updateQuantity(productId, newQuantity);
                    renderCart(); // Re-render cart after quantity update
                }
            });

            // Event listener for remove button
            cartItemsContainer.addEventListener('click', (event) => {
                if (event.target.tagName === 'BUTTON' && event.target.textContent === 'Remove') {
                    const productId = event.target.dataset.productId;
                    removeFromCart(productId);
                    renderCart(); // Re-render cart after item removal
                }
            });

            checkoutButton.addEventListener('click', () => {
                window.location.href = '/checkout.html';
            });

            renderCart(); // Initial render of the cart
        });
    </script>
</body>
</html>
